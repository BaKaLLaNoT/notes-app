(this.webpackJsonppart1=this.webpackJsonppart1||[]).push([[0],{55:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(24),o=n.n(c),a=n(7),s=n(2),i=n(25),u=n(9),j=n(4),l=n(11),b=n.n(l),d="/api/notes",O=null,h=function(){return b.a.get(d).then((function(e){return e.data}))},f=function(e){var t={headers:{Authorization:O}};return b.a.post(d,e,t).then((function(e){return e.data}))},p=function(e,t){var n={headers:{Authorization:O}};return b.a.put("".concat(d,"/").concat(e),t,n).then((function(e){return e.data}))},x=function(e){O="Bearer ".concat(e)},m=function(){var e=Object(r.useState)([]),t=Object(j.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){h().then((function(e){c(e)}))}),[]);return{addNote:function(e){f(e).then((function(e){c(n.concat(e))}))},toggleImportanceOf:function(e){var t=n.find((function(t){return t.id===e})),r=Object(u.a)(Object(u.a)({},t),{},{important:!t.important});p(e,r).then((function(t){c(n.map((function(n){return n.id!==e?n:t})))}))},notes:n}},g=n(0),v=function(){var e,t=Object(s.h)().noteId,n=m().notes.find((function(e){return e.id===t}));return n?Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{children:n.content}),Object(g.jsx)("div",{children:null===(e=n.user)||void 0===e?void 0:e.name}),Object(g.jsx)("div",{children:Object(g.jsx)("strong",{children:n.important?"important":""})})]}):null},w=n(8),y=n.n(w),S=n(10),N=function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k={login:N},C=function(){var e=Object(r.useState)(null),t=Object(j.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteAppUser");if(e){var t=JSON.parse(e);c(t),x(t.token)}}),[]);var o=function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.next=3,k.login({username:n,password:r});case 3:o=e.sent,console.log(o),window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(o)),x(o.token),c(o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{user:n,login:o,logout:function(){c(null),x(n.token),window.localStorage.removeItem("loggedNoteAppUser")}}},I=function(e){var t=e.note,n=e.toggleImportance,r=t.important?"make not important":"make important";return Object(g.jsxs)("li",{className:"note",children:[Object(g.jsx)(a.b,{to:"/notes/".concat(t.id),children:t.content}),Object(g.jsx)("button",{onClick:n,children:r})]})},L=Object(r.forwardRef)((function(e,t){var n=e.children,c=e.buttonLabel,o=Object(r.useState)(!1),a=Object(j.a)(o,2),s=a[0],i=a[1],u={display:s?"none":""},l={display:s?"":"none"},b=function(){return i(!s)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:b}})),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{style:u,children:Object(g.jsx)("button",{onClick:b,children:c})}),Object(g.jsxs)("div",{style:l,children:[n,Object(g.jsx)("button",{onClick:b,children:"Cancel"})]})]})}));L.displayName="Togglable";var U=L;function A(e){var t=e.addNote,n=e.handleLogout,c=Object(r.useState)(""),o=Object(j.a)(c,2),a=o[0],s=o[1],i=Object(r.useRef)();return Object(g.jsxs)(U,{buttonLabel:"New Note",ref:i,children:[Object(g.jsx)("h3",{children:"Create a new note"}),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({content:a,important:!1}),s(""),i.current.toggleVisibility()},children:[Object(g.jsx)("input",{placeholder:"Write your note content",value:a,onChange:function(e){s(e.target.value)}}),Object(g.jsx)("button",{type:"submit",children:"save"})]}),Object(g.jsx)("div",{children:Object(g.jsx)("button",{onClick:n,children:"Logout"})})]})}var H=function(){var e=m(),t=e.notes,n=e.addNote,c=e.toggleImportanceOf,o=C(),a=o.user,s=o.logout,i=Object(r.useState)(!0),u=Object(j.a)(i,2),l=u[0],b=u[1],d=Object(r.useState)(null),O=Object(j.a)(d,2),h=O[0],f=O[1];if(h)return Object(g.jsx)("p",{children:h});var p=l?t:t.filter((function(e){return e.important}));return Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"Notes"}),a?Object(g.jsx)(A,{addNote:n,handleLogout:s}):null,Object(g.jsx)("div",{children:Object(g.jsxs)("button",{onClick:function(){return b(!l)},children:["show ",l?"important":"all"]})}),Object(g.jsx)("ul",{children:p.map((function(e,t){return Object(g.jsx)(I,{note:e,toggleImportance:function(){return t=e.id,void c(t).catch((function(){f("Note was already removed from server"),setTimeout((function(){f(null)}),5e3)}));var t}},t)}))})]})},J=function(e){var t=e.type,n=Object(r.useState)(""),c=Object(j.a)(n,2),o=c[0],a=c[1];return{type:t,value:o,onChange:function(e){a(e.target.value)}}};function P(e){var t=e.handleSubmit,n=J({type:"text"}),r=J({type:"password"});return Object(g.jsxs)("form",{onSubmit:t,children:[Object(g.jsx)("div",{children:Object(g.jsx)("input",Object(u.a)(Object(u.a)({},n),{},{name:"Username",placeholder:"Username"}))}),Object(g.jsx)("div",{children:Object(g.jsx)("input",Object(u.a)(Object(u.a)({},r),{},{name:"Password",placeholder:"Password"}))}),Object(g.jsx)("button",{id:"form-login-button",children:"Login"})]})}var E=function(e){var t=e.message;return null===t?null:Object(g.jsx)("div",{className:"error",children:t})};function T(){var e=Object(s.g)(),t=C(),n=t.user,c=t.login,o=Object(r.useState)(""),a=Object(j.a)(o,2),i=a[0],u=a[1],l=Object(r.useState)(""),b=Object(j.a)(l,2),d=b[0],O=b[1],h=Object(r.useState)(null),f=Object(j.a)(h,2),p=f[0],x=f[1],m=function(){var t=Object(S.a)(y.a.mark((function t(n){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{c({username:i,password:d}),u(""),O(""),e("/notes")}catch(r){x("Wrong credentials!"),setTimeout((function(){x(null)}),5e3)}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return p?Object(g.jsx)("p",{children:p}):n?Object(g.jsx)("p",{children:"User is logged"}):Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"Login"}),Object(g.jsx)(E,{message:p}),Object(g.jsx)(P,{username:i,password:d,handleUsernameChange:function(e){var t=e.target;return u(t.value)},handlePasswordChange:function(e){var t=e.target;return O(t.value)},handleSubmit:m})]})}var z=function(){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(i.a,{children:Object(g.jsx)("title",{children:"Home | Notes App"})}),Object(g.jsx)("h1",{children:"Home Page"})]})},B=function(){return Object(g.jsx)("h1",{children:"Users"})},D=function(){var e=C().user,t={padding:5};return Object(g.jsxs)(r.Suspense,{fallback:Object(g.jsx)("span",{children:"Loading component.."}),children:[Object(g.jsxs)("header",{children:[Object(g.jsx)(a.b,{to:"/",style:t,children:"Home"}),Object(g.jsx)(a.b,{to:"/notes",style:t,children:"Notes"}),Object(g.jsx)(a.b,{to:"/users",style:t,children:"Users"}),e?Object(g.jsxs)("em",{children:["Logged as ",e.name]}):Object(g.jsx)(a.b,{to:"/login",style:t,children:"Login"})]}),Object(g.jsxs)(s.d,{children:[Object(g.jsx)(s.b,{path:"/login",element:e?Object(g.jsx)(s.a,{to:"/"}):Object(g.jsx)(T,{})}),Object(g.jsx)(s.b,{path:"/notes",element:Object(g.jsx)(H,{})}),Object(g.jsx)(s.b,{path:"/notes/:noteId",element:Object(g.jsx)(v,{})}),Object(g.jsx)(s.b,{path:"/users",element:e?Object(g.jsx)(B,{}):Object(g.jsx)(s.a,{to:"/login"})}),Object(g.jsx)(s.b,{path:"/",element:Object(g.jsx)(z,{})}),Object(g.jsx)(s.b,{element:Object(g.jsx)("h1",{children:"Not found"})})]})]})};n(55),n(56);o.a.render(Object(g.jsx)(a.a,{children:Object(g.jsx)(D,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.d575d6aa.chunk.js.map